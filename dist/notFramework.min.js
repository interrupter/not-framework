function capitalizeFirstLetter(a){"use strict";return a.charAt(0).toUpperCase()+a.slice(1)}function getAttributesStartsWith(a,b){for(var c=a.querySelectorAll(":scope *"),d=[],e=0;e<c.length;e++)for(var f=0,g=c[e].attributes,h=g.length;h>f;f++)if(0===g[f].nodeName.indexOf(b)){d.push(c[e]);break}return d}String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var notApp=function(a){this._notOptions=a,this.resources={},this._working={interfaces:{},controllers:{},initController:null,currentController:null,forms:{}}};if(notApp.prototype.exec=function(){var a=this._notOptions.interfaceManifestURL,b=this._setInterfaceManifest.bind(this);$.ajax({dataType:"json",data:"",url:a,success:b})},notApp.prototype._setInterfaceManifest=function(a){this._notOptions.interfaceManifest=a,this._update()},notApp.prototype._getInterfaceManifest=function(){return this._notOptions.interfaceManifest},notApp.prototype._update=function(){this._updateInterfaces(),this._initController(),this._initFormBuilders(),this.allResourcesReady()&&this.startApp()},notApp.prototype.startApp=function(){this._initRouter()},notApp.prototype._bindController=function(a){var b=new notController(this,a);return b.exec.bind(b)},notApp.prototype._initController=function(){"undefined"!=typeof this._notOptions.initController&&(this._working.initController=new notController(this,this._notOptions.initController),this._working.initController.exec())},notApp.prototype._initRouter=function(){var a={},b=this;$.each(this._notOptions.siteManifest,function(c,d){a[c]=b._bindController(d)}),this._working.router=routie(a)},notApp.prototype._getCurrentController=function(){return this._working.currentController},notApp.prototype._setCurrentController=function(a){return this._working.currentController=a,this},notApp.prototype._updateInterfaces=function(){this._clearInterfaces(),this._notOptions.hasOwnProperty("interfaceManifest")&&$.each(this._notOptions.interfaceManifest,this._initInterface.bind(this))},notApp.prototype._getRecordName=function(a){return"nr"+a.capitalizeFirstLetter()},notApp.prototype._getControllerName=function(a){return"nc"+a.capitalizeFirstLetter()},notApp.prototype._initInterface=function(a,b){console.log(a,b),this._working.interfaces[this._getRecordName(a)]=new notRecord(b)},notApp.prototype._getInterfaces=function(){return this._working.interfaces},notApp.prototype._clearInterfaces=function(){this._working.interfaces={}},notApp.prototype._initFormBuilders=function(){this._clearFormBuilders(),this._notOptions.hasOwnProperty("forms")&&$.each(this._notOptions.forms,this._initFormBuilder.bind(this))},notApp.prototype._initFormBuilder=function(a,b){console.log("init form builder",a,b),this._working.forms[a]=new notForm(this,b),this._working.forms[a].init(this.waitThisResource("form",a))},notApp.prototype._getFormBuilders=function(){return this._working.forms},notApp.prototype._clearFormBuilders=function(){this._working.forms={}},notApp.prototype.waitThisResource=function(a,b){return this.resources.hasOwnProperty(a)||(this.resources[a]={}),this.resources[a][b]=!1,this.onResourceReady.bind(this,a,b)},notApp.prototype.onResourceReady=function(a,b){this.resources[a][b]=!0,this.allResourcesReady()&&this.startApp()},notApp.prototype.allResourcesReady=function(){var a,b;for(a in this.resources)for(b in this.resources[a])if(!this.resources[a][b])return!1;return!0},notApp.prototype.getOptions=function(){return this._notOptions.options},"undefined"==typeof extend||null===extend)var extend=function(a,b){var c,d={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c]);return d};var notController=function(a,b){this.app=a,this.ncName="nc"+b.capitalizeFirstLetter(),this.containerSelector=".page-content",this.viewsPostfix=".html",this.renderFromURL=!0;var c=this;$.each(this.app._getInterfaces(),function(a,b){"undefined"!=typeof window[c.ncName]&&(window[c.ncName].prototype[a]=b)})};if(notController.prototype.$render=function(a,b,c,d,e){var f=a.views.hasOwnProperty(b)?a.views[b]:null;if("undefined"!=typeof f&&null!==f){switch(("undefined"==typeof f.place||null===f.place)&&"undefined"!=typeof f.placeId&&null!==f.placeId&&f.placeId.length>0&&(f.place=document.getElementById(f.placeId)),arguments.length){case 4:realCallback=d,realHelpers={};break;default:realHelpers=d,realCallback=e}f.data=c,"undefined"!=typeof f.helpers&&null!==f.helpers&&Object.keys(f.helpers).length>0?f.helpers=extend(f.helpers,realHelpers):f.helpers=realHelpers,a.renderFromURL?("undefined"==typeof f.templateURL||null==f.templateURL||0==f.templateURL.length)&&(f.templateURL=(f.common?a.commonViewsPrefix:a.viewsPrefix)+("undefined"!=typeof f.name&&null!==f.name&&f.name.length>0?f.name:b)+a.viewsPostfix):f.hasOwnProperty("templateName")&&(f.templateName=a.viewsPrefix+f.templateName+a.viewsPostfix),new notTemplate(f).execAndPut(f.place,realCallback)}},notController.prototype.exec=function(a){if(console.log("exec",this,Object.keys(this.__proto__)),"undefined"!=typeof window[this.ncName]){var b=Object.keys(this.__proto__).filter(function(a){return 0===a.indexOf("$")});if(b.length>0)for(var c in b)window[this.ncName].prototype[b[c]]=this.__proto__[b[c]];console.log(new window[this.ncName](this.app,a)),console.log("after new controller")}},"undefined"==typeof extend||null===extend)var extend=function(a,b){var c,d={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c]);return d};var notForm=function(a,b){return this.app=a,this._params={runActionOnSubmit:!0,removeOnRestore:!0,afterSubmit:function(a){},afterRestore:function(a){}},this.options=b,this._working={template:"",prefix:"notForm_",formElements:{},defaulField:{type:"text",placeholder:"text placeholder"}},this};notForm.prototype.setOption=function(a,b){return this.options[a]=b,this},notForm.prototype.getOption=function(a){return this.options[a]},notForm.prototype.init=function(a){this._working.onReady=a,this.loadTemplate(a)},notForm.prototype.loadTemplate=function(){var a=new XMLHttpRequest;a.open("GET",this.options.templateUrl),a.addEventListener("load",this._setTemplate.bind(this)),a.send()},notForm.prototype._setTemplate=function(a){this._working.template=a.srcElement.responseText,this.parseTemplate(),this._working.onReady()},notForm.prototype.parseTemplate=function(){var a=document.createElement("DIV");return a.innerHTML=this._working.template,a.children},notForm.prototype._getFormElementTemplate=function(a,b){var c=document.createElement("DIV");c.innerHTML=this._working.template;var d=c.children,e=0,f=this._working.prefix+a;for(e=0;e<d.length;e++){var g=d[e];if("#text"!==g.nodeName&&g.dataset.notTemplateName==f)return b?g.outerHTML:g.innerHTML}return""},notForm.prototype._getFieldValue=function(a,b){var c="";return a&&a.hasOwnProperty(b)&&(c="object"==typeof a[b]&&a[b].hasOwnProperty("_id")?a[b]._id:a[b]),c},notForm.prototype.buildFormElement=function(a){var b=this._getParams(),c=this._getFormField(a),d={fieldValue:b&&"undefined"!=typeof b.data&&null!==b.data?this._getFieldValue(b.data,a):"",fieldName:a,fieldLabel:c.hasOwnProperty("label")?c.label:"",fieldId:a+"Input",fieldPlaceHolder:c.hasOwnProperty("placeholder")?c.placeholder:"",option:c.hasOwnProperty("option")?c.option:{value:"_id",label:"title"},optionsLib:b.hasOwnProperty(a+"Lib")?b[a+"Lib"]:[]},e={value:d.fieldValue};return new notTemplate({template:this._getFormElementTemplate(c.type,!0),helpers:d,data:e}).exec()},notForm.prototype.buildFormElements=function(a){var b=[],c=0;for(c=0;c<a.length;c++)this._working.formElements[a[c]]=this.buildFormElement(a[c])[0],console.log(this._working.formElements[a[c]]instanceof HTMLElement?"Element":"not Element"),this._working.formElements[a[c]].hasOwnProperty("classList")&&this._working.formElements[a[c]].classList.add(a[c]+"_InputGroup"),b.push(this._working.formElements[a[c]]);return b},notForm.prototype.buildFormWrapper=function(a){var b=this._getParams();return new notTemplate({template:this._getFormElementTemplate(a,!0),data:this._getParams(),helpers:{formTitle:this._getFormTitle(),formId:"Form_"+b.modelName+"_"+b.actionName,formName:"Form_"+b.modelName+"_"+b.actionName,formContainerId:"FormContainer_"+b.modelName+"_"+b.actionName}}).exec()},notForm.prototype.buildForm=function(){var a="",b=0,c=this._getScenario();if("undefined"!=typeof c&&null!==c){var d=this.buildFormElements(c.fields);a=this.buildFormWrapper(this._getParams().formType),a=a instanceof HTMLCollection?a[0]:a;var e=a.querySelectorAll(":scope form")[0];for(console.log(a.querySelectorAll(":scope form")),b=0;b<d.length;b++)if(d[b]instanceof HTMLCollection)for(var f=0;f<d[b].length;f++)e.appendChild(d[b][f]);else e.appendChild(d[b])}return this._working.resultForm=a,this._working.resultForm},notForm.prototype._getScenario=function(){var a=this._getAction(),b=this._getParams();return a.hasOwnProperty("form")?b.hasOwnProperty("scenario")&&a.form.hasOwnProperty("scenario")?a.form.scenario.hasOwnProperty(b.scenario)?a.form.scenario[b.scenario]:a.form[b.scenario]:a.form:null},notForm.prototype._getParams=function(){return this._working.params},notForm.prototype._getAction=function(){var a=this._getModel();return a.actions[this._getActionName()]},notForm.prototype._getActionName=function(){return this._getParams().actionName},notForm.prototype._getFormTitle=function(){var a=this._getAction();return a.hasOwnProperty("form")&&a.form.hasOwnProperty("title")?a.form.title:"Form title"},notForm.prototype._collectFieldsDataToRecord=function(){console.log(this._working.resultForm);var a=this._getParams(),b=a.data,c=this._getScenario(),d=(this._getFormFieldsTypes(),this._working.resultForm.querySelectorAll(":scope form")[0]),e=0,f=null,g=null,h=null,i=new FormData(d);for(e=0;e<c.fields.length;e++){switch(g=c.fields[e],f=this._getFormField(g),f.type){case"text":case"select":case"textarea":case"checkbox":h=d.querySelectorAll(':scope [name="'+g+'"]')[0].value;break;case"submit":case"file":continue;default:h=d.querySelectorAll(':scope [name="'+g+'"]')[0].value}b.setAttr(g,h)}b.setParam("formData",i),b["$"+a.actionName](this._onSubmitSuccess.bind(this),this._validationErrorsHandling.bind(this))},notForm.prototype._onSubmitSuccess=function(a){var b=this._getParams();this._validationErrorsHandling(),this._removeForm(),b.hasOwnProperty("afterSubmit")?b.afterSubmit(a):null},notForm.prototype._setValidationErrorForField=function(a,b){this._working.formElements[a].classList.add("has-error");var c=this._working.formElements[a].querySelectorAll(":scope .help-block")[0];c&&(c.textContent=b,c.style.WebkitTransition="opacity 1s",c.style.MozTransition="opacity 1s")},notForm.prototype._setValidationSuccessForField=function(a){this._working.formElements[a].classList.add("has-success")},notForm.prototype._validationErrorsHandling=function(a){var b;for(b in this._working.formElements)"undefined"!=typeof a&&null!==a&&a.hasOwnProperty(b)?this._setValidationErrorForField(b,a[b]):(this._resetValidationErrorForField(b),this._setValidationSuccessForField(b))},notForm.prototype._resetValidationErrorForField=function(a){this._working.formElements[a].classList.remove("has-error");var b=this._working.formElements[a].querySelectorAll(":scope .help-block")[0];b&&(b.style.WebkitTransition="opacity 1s",b.style.MozTransition="opacity 1s")},notForm.prototype.attachOnSubmitAction=function(){this._working.resultForm.querySelectorAll(":scope form")[0].addEventListener("submit",this._submitForm.bind(this))},notForm.prototype._submitForm=function(a){return a.stopPropagation(),a.preventDefault(),this._collectFieldsDataToRecord(),!1},notForm.prototype.attachRemoveOnRestore=function(){this._working.resultForm.querySelectorAll(':scope button[type="restore"]')[0].addEventListener("click",this._removeForm.bind(this))},notForm.prototype._removeForm=function(a){return"undefined"!=typeof a&&null!==a&&a.preventDefault(),this._working.resultForm.remove(),"undefined"!=typeof a&&null!==a&&(this._getParams().hasOwnProperty("afterRestore")?this._getParams().afterRestore(a):null),!1},notForm.prototype._getModelName=function(){if("undefined"!=typeof this._getParams().modelName&&null!==this._getParams().modelName)return this._getParams().modelName;if(this._getParams().hasOwnProperty("data")){var a=this._getParams().data;if("undefined"!=typeof a.modelName&&null!==a.modelName)return a.modelName;if("undefined"!=typeof a.getModelName&&null!==a.getModelName)return a.getModelName()}return null},notForm.prototype._getModel=function(){return this.app._getInterfaceManifest()[this._getModelName()]},notForm.prototype._getFormFieldsTypes=function(){var a=this._getModel();return a.formFieldsTypes},notForm.prototype._getFormField=function(a){var b=this._getFormFieldsTypes();return"undefined"!=typeof b&&null!==b&&b.hasOwnProperty(a)?b[a]:this._getDefaultField()},notForm.prototype._getDefaultField=function(){return this._working.defaulField},notForm.prototype._clearWorking=function(){this._working.resultForm=null,this._working.formElements={}},notForm.prototype.build=function(a){return this._clearWorking(),this._working.params=extend(this._params,a),console.log("build form ",this._getModelName(),this._getActionName(),this._getFormFieldsTypes(),this._getParams()),this.buildForm(),this.attachOnSubmitAction(),this.attachRemoveOnRestore(),this._working.resultForm};var pager={COMPLECTS_PER_PAGE:20,MAX_PAGES_IN_CACHE:2,PAGE_NUMBER_MINIMUM:1,PAGE_NUMBER_MAXIMUM:1,pageNumberCurrent:{left:null,right:null},cacheSize:0,lastDirection:"",apiBlocked:!1,complects:[],apiURL:"",getFilterParams:function(){return{}},nextPage:function(){return this.lastDirection="next",null===this.pageNumberCurrent.right?this.pageNumberCurrent.right=1:this.pageNumberCurrent.right++,this.checkBorders()?!0:(this.pageNumberCurrent.right--,!1)},prevPage:function(){return this.lastDirection="prev",null===this.pageNumberCurrent.left?this.pageNumberCurrent.left=0:this.pageNumberCurrent.left--,this.checkBorders()?!0:(this.pageNumberCurrent.left++,!1)},checkBorders:function(){return this.pageNumberCurrent.right+Math.abs(this.pageNumberCurrent.left)<=this.PAGE_NUMBER_MAXIMUM},addPage:function(a){console.log("recieved",a);var b=!1;switch(this.PAGE_NUMBER_MAXIMUM=parseInt(a.PAGES),this.cacheSize++,this.lastDirection){case"prev":this.complects=a.ELEMENTS.concat(this.complects),this.cacheSize>this.MAX_PAGES_IN_CACHE&&(this.complects=this.complects.slice(0,this.complects.length-this.COMPLECTS_PER_PAGE),this.cacheSize--,b=!0);break;case"next":this.complects=this.complects.concat(a.ELEMENTS),this.cacheSize>this.MAX_PAGES_IN_CACHE&&(this.complects=this.complects.slice(this.COMPLECTS_PER_PAGE,this.complects.length),this.cacheSize--,b=!0)}this.unBlockApi(),console.log("CacheSize:",this.cacheSize),console.log("rebuilded complects:",this.complects),this.onPageLoad(this.complects,a.ELEMENTS,this.lastDirection,b)},getRequestedPagesNumber:function(){switch(this.lastDirection){case"next":return this.pageNumberCurrent.right;case"prev":return this.PAGE_NUMBER_MAXIMUM+this.pageNumberCurrent.left}},apiLoad:function(){var a={filter:this.getFilterParams(),pageSize:this.COMPLECTS_PER_PAGE,pageNum:this.getRequestedPagesNumber()};this.blockApi(),console.log("pager params:",jQuery.param(a)),$.getJSON(this.apiURL+"?"+jQuery.param(a),this.addPage.bind(this))},loadNextPage:function(){!this.apiBlocked&&this.nextPage()&&this.apiLoad()},loadPrevPage:function(){!this.apiBlocked&&this.prevPage()&&this.apiLoad()},unBlockApi:function(){this.apiBlocked=!1},blockApi:function(){this.apiBlocked=!0},reset:function(){this.complects=[],this.cacheSize=0,this.pageNumberCurrent={left:null,right:null},this.lastDirection="",this.apiBlocked=!1},onPageLoad:function(a,b,c){console.log("rebuildElements of complects")}};String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var notRecord_stdObjectProps={writable:!1,enumerable:!1},DEFAULT_RECORD_ID_FIELD_NAME="_id",DEFAULT_PAGE_NUMBER=1,DEFAULT_PAGE_SIZE=10,notRecord_Interface={extendObject:function(a,b){"use strict";var c="";for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},parseLine:function(a,b,c){"use strict";for(var d=":record[",e="";a.indexOf(d)>-1;)e=a.slice(a.indexOf(d)+d.length,a.indexOf("]")-a.indexOf(d)+1),a=a.replace(":record["+e+"]",b.getAttr(e));return a=a.replace(":modelName",b._notOptions.interfaceManifest.model),a=a.replace(":actionName",c)},getURL:function(a,b,c){"use strict";var d=this.parseLine(a._notOptions.interfaceManifest.url,a,c)+(b.hasOwnProperty("postFix")?this.parseLine(b.postFix,a,c):"");return d},collectRequestData:function(a,b){"use strict";var c={},d=0;if(b.hasOwnProperty("data")&&"undefined"!=typeof b.data&&null!==b.data)for(d=0;d<b.data.length;d++){var e="get"+capitalizeFirstLetter(b.data[d]);e in a&&(c=this.extendObject(c,a[e]()))}var f=new FormData;if(Object.keys(c).length>0)for(var d in c)f.append(d,c[d]);return"POST"===b.method?a.getParam("formData"):c},request:function(a,b,c,d){"use strict";console.log("request",b);var e=a._notOptions.interfaceManifest.actions[b],f={cache:!1,contentType:!1,processData:!1},g=this.collectRequestData(a,e),h={method:e.method,data:g,complete:function(b,f){var g=[];if(b=b.responseJSON,"success"==f?("isArray"in e&&e.isArray?$.each(b,function(b,c){g.push(new notRecord(a._notOptions.interfaceManifest,c))}):g=new notRecord(a._notOptions.interfaceManifest,b),c(g)):"undefined"!=typeof d&&null!==d&&"error"===f&&d(b),"undefined"!=typeof a._notOptions.interfaceManifest.showMessages&&a._notOptions.interfaceManifest.showMessages){var h=e.hasOwnProperty("messages")&&e.messages.hasOwnProperty(f)?e.messages[f]:b.error;"undefined"!=typeof h&&""!=h&&$(".top-left").notify({type:"success"==f?f:"danger",message:{text:h}}).show()}}};if(g instanceof FormData)var i=jQuery.extend(h,f);else var i=h;console.log("finalParams",i),$.ajax(this.getURL(a,e,b),i)}},notRecord=function(a,b){"use strict";this._notOptions={interfaceManifest:a,filter:{},sorter:{},pageNumber:DEFAULT_PAGE_NUMBER,pageSize:DEFAULT_PAGE_SIZE,fields:[]},"undefined"!=typeof b&&null!==b&&(notRecord_Interface.extendObject(this,b),this._notOptions.fields=Object.keys(b),this._addMetaAttrs());var c=this;return $.each(this._notOptions.interfaceManifest.actions,function(b,d){this.hasOwnProperty("$"+b)?console.error("interface manifest for ",a.model,' conflict with notRecord property "',"$"+b,'" that alredy exists'):c["$"+b]=function(a,c){console.log("$"+b),notRecord_Interface.request.bind(notRecord_Interface,this,b+"",a,c).call()}}),this};Object.defineProperties(notRecord.prototype,{modelName:{get:function(){"use strict";return this._notOptions.interfaceManifest.model}},interfaceManifest:{get:function(){"use strict";return this._notOptions.interfaceManifest}}}),notRecord.prototype.setParam=function(a,b){"use strict";return this._notOptions[a]=b,this},notRecord.prototype.getParam=function(a){"use strict";return this._notOptions[a]},notRecord.prototype.getModelName=function(){"use strict";return this._notOptions.interfaceManifest.model},notRecord.prototype.getFieldTitle=function(a){var b=a;return"undefined"!=typeof this._notOptions.interfaceManifest.formFieldsTypes&&this._notOptions.interfaceManifest.formFieldsTypes.hasOwnProperty(a)?this._notOptions.interfaceManifest.formFieldsTypes[a].hasOwnProperty("label")?this._notOptions.interfaceManifest.formFieldsTypes[a].label:this._notOptions.interfaceManifest.formFieldsTypes[a].hasOwnProperty("placeholder")?this._notOptions.interfaceManifest.formFieldsTypes[a].placeholder:this._notOptions.interfaceManifest.formFieldsTypes[a].hasOwnProperty("caption")?this._notOptions.interfaceManifest.formFieldsTypes[a].caption:void 0:b},notRecord.prototype.getFieldTitles=function(){var a=[];if("undefined"!=typeof this._notOptions.interfaceManifest.formFieldsTypes&&this._notOptions.interfaceManifest.formFieldsTypes&&Object.keys(this._notOptions.interfaceManifest.formFieldsTypes).length>0)for(var b=0;b<this.getParam("fields").length;b++){var c=this.getParam("fields")[b],d={};d[c]=this.getFieldTitle(c),a.push(d)}return a},notRecord.prototype._addMetaAttrs=function(){var a,b,c,d=this.getParam("fields");for(a in d)b=d[a],c=typeof this[b],"object"===c&&this._addMetaAttr(b,this[b])},notRecord.prototype._addMetaAttr=function(a,b){var c;for(c in b)k=c+"",Object.defineProperty(this,a+c.capitalizeFirstLetter(),{get:function(b){"use strict";return this[a][b]}.bind(this,c)})},notRecord.prototype.setAttr=function(a,b){"use strict";var c=this.getParam("fields");return-1==c.indexOf(a)&&(c.push(a),this.setParam("fields",c)),this[a]=b,"Object"==typeof b&&notRecord.prototype._addMetaAttr(a,b),this},notRecord.prototype.setAttrs=function(a){"use strict";var b;for(b in a)this.setAttr(b,a[b]);return this},notRecord.prototype.getAttr=function(a){"use strict";return this.getParam("fields").indexOf(a)>-1?this[a]:void 0},notRecord.prototype.setFilter=function(a){"use strict";return this.setParam("filter",a),this},notRecord.prototype.getFilter=function(){"use strict";return this.getParam("filter")},notRecord.prototype.setSorter=function(a){"use strict";return this.setParam("sorter",a),this},notRecord.prototype.getSorter=function(){"use strict";return this.getParam("sorter")},notRecord.prototype.setPageNumber=function(a){"use strict";return this.setParam("pageNumber",a),this},notRecord.prototype.setPageSize=function(a){"use strict";return this.setParam("pageSize",a),this},notRecord.prototype.setPager=function(a,b){"use strict";return this.setParam("pageSize",a).setParam("pageNumber",b),this},notRecord.prototype.getPager=function(){"use strict";return{pageSize:this.getParam("pageSize"),pageNumber:this.getParam("pageNumber")}},notRecord.prototype.getRecord=function(){"use strict";var a,b={},c=0,d=this.getParam("fields");for(c=0;c<d.length;c++)a=d[c],b[a]=this.getAttr(a);return b},notRecord.prototype.setFindBy=function(a,b){"use strict";var c={};return c[a]=b,this.setFilter(c)};var notTable=function(a){return this.options=a,this._working={templateNamesPrefix:"notTable_",viewPrefs:{sorter:{},filter:{},pager:{pageSize:10,pageNumber:0}},filteredData:[]},this.init(),this};notTable.prototype.init=function(){var a=new XMLHttpRequest;a.open("GET",this.options.templateUrl),a.addEventListener("load",this._setTemplate.bind(this)),a.send()},notTable.prototype._setTemplate=function(a){this._working.template=a.srcElement.responseText,this.parseTemplate(),this.build()},notTable.prototype.parseTemplate=function(){var a=document.createElement("DIV");a.innerHTML=this._working.template,this._working.templateElements={};for(var b=0;b<a.children.length;b++){var c=a.children[b];if(c.nodeType===Node.ELEMENT_NODE&&c.dataset.hasOwnProperty("notTemplateName")){var d=c.dataset.notTemplateName.replace(this._working.templateNamesPrefix,"");this._working.templateElements[d]=c}}return this._working.templateElements},notTable.prototype.build=function(){var a=this;this.views={wrapper:new notView({templateOptions:{templateElement:this._working.templateElements.wrapper,helpers:this.options.helpers},placeToPut:this.options.place,afterExec:function(){a.renderHeader(),a.updateData(),a.renderBody(),a.bindSearch()}})},this.renderWrapper()},notTable.prototype.renderWrapper=function(){this.views.wrapper.exec()},notTable.prototype.renderHeader=function(){for(var a=this.options.place.querySelectorAll(":scope thead tr")[0],b=0;b<this.options.headerTitles.length;b++){var c=document.createElement("TH");c.innerHTML=this.options.headerTitles[b].title,c.dataset.dataFieldName=this.options.headerTitles[b].field,c.dataset.sortingDirection=0,this.options.headerTitles[b].hasOwnProperty("sortable")&&this.options.headerTitles[b].sortable&&this.attachSortingHandlers(c),a.appendChild(c)}},notTable.prototype.renderBody=function(){this.options.onePager||(this.options.place.querySelectorAll(":scope tbody")[0].innerHTML="");for(var a=this.options.pageSize*this.options.pageNumber,b=this.options.pageSize*(this.options.pageNumber+1),c=this.options.place.querySelectorAll(":scope tbody")[0],d=a;d<Math.min(b,this._working.filteredData.length);d++)c.appendChild(this.renderRow(this._working.filteredData[d]))},notTable.prototype.refreshBody=function(){this.options.place.querySelectorAll(":scope tbody")[0].innerHTML="";for(var a=0,b=this.options.pageSize*(this.options.pageNumber+1),c=this.options.place.querySelectorAll(":scope tbody")[0],d=a;d<Math.min(b,this._working.filteredData.length);d++)c.appendChild(this.renderRow(this._working.filteredData[d]))},notTable.prototype.renderRow=function(a,b){for(var c=document.createElement("TR"),d=0;d<this.options.headerTitles.length;d++){var e=document.createElement("TD");e.innerHTML=this.options.headerTitles[d].hasOwnProperty("proccessor")?this.options.headerTitles[d].proccessor(a[this.options.headerTitles[d].field],a,b):a[this.options.headerTitles[d].field],c.appendChild(e)}return this.options.hasOwnProperty("procRow")?this.options.procRow(c,a):c},notTable.prototype.attachSortingHandlers=function(a){var b=this;a.addEventListener("click",function(a){return a.preventDefault(),b.changeSortingOptions(this),!1}),a.style.cursor="pointer"},notTable.prototype.changeSortingOptions=function(a){if(0===parseInt(a.dataset.sortingDirection)?a.dataset.sortingDirection=1:a.dataset.sortingDirection=-1*parseInt(a.dataset.sortingDirection),a.parentNode)for(var b=0;b<a.parentNode.children.length;b++)a.parentNode.children[b]!==a&&(a.parentNode.children[b].classList.remove("sorting_asc"),a.parentNode.children[b].classList.remove("sorting_desc"));parseInt(a.dataset.sortingDirection)>0?(a.classList.remove("sorting_desc"),a.classList.add("sorting_asc"),a.setAttribute("aria-sort","ascending")):(a.classList.remove("sorting_asc"),a.classList.add("sorting_desc"),a.setAttribute("aria-sort","descending")),this.setSorter({sortDirection:a.dataset.sortingDirection,sortByField:a.dataset.dataFieldName})},notTable.prototype.setSorter=function(a){this._working.viewPrefs.sorter=a,this.updateData()},notTable.prototype.getSorter=function(){return this._working.viewPrefs.sorter},notTable.prototype.getFilterSearch=function(){return"undefined"!=typeof this.getFilter()&&null!==this.getFilter()&&"undefined"!=typeof this.getFilter().filterSearch&&null!==this.getFilter().filterSearch?this.getFilter().filterSearch.toString():""},notTable.prototype.setFilter=function(a){this._working.viewPrefs.filter=a,this.updateData()},notTable.prototype.getFilter=function(){return this._working.viewPrefs.filter},notTable.prototype.setPager=function(a){this._working.viewPrefs.pager=a,this.updateData()},notTable.prototype.getPager=function(a){return this._working.viewPrefs.pager},notTable.prototype.testDataItem=function(a){var b=this.getFilterSearch().toLowerCase();for(var c in a){var d=a[c].toString().toLowerCase();if(d.indexOf(b)>-1)return!0}return!1},notTable.prototype.updateData=function(){var a=this;this.options.liveLoad&&this.options.notRecord?(this.options.notRecord=this.options.notRecord.setFilter(this.getFilter()).setSorter(this.getSorter()).setPager(this.getPager().pageSize,this.getPager().pageNumber),this.options.notRecord.$list(function(b){console.log("$list for table",b),a._working.filteredData=b,a.refreshBody()})):(this.proccessData(),this.refreshBody())},notTable.prototype.proccessData=function(){var a=that.getFilter();"undefined"!=typeof a&&null!==a&&"undefined"!=typeof a.filterSearch&&null!==a.filterSearch&&a.filterSearch.length>0?this._working.filteredData=this.options.data.filter(that.testDataItem.bind(that)):this._working.filteredData=this.options.data;var b=that.getSorter();"undefined"!=typeof b&&null!==b&&this._working.filteredData.sort(function(a,c){return isNaN(a[b.fieldName])?a[b.fieldName].localeCompare(c[b.fieldName])*-b.direction:(a[b.fieldName]<c[b.fieldName]?1:-1)*b.direction})},notTable.prototype.bindSearch=function(){var a=this.options.place.querySelectorAll(':scope input[name="search"]')[0],b=this,c=function(a){return b.setFilter({filterSearch:this.value}),!0};a.addEventListener("keyup",c),a.addEventListener("enter",c)},notTable.prototype.setData=function(){},notTable.prototype.getData=function(){},notTable.prototype.addData=function(){},notTable.prototype.loadNext=function(){this.options.pageNumber++,this.updateData()},notTable.prototype.setParam=function(a,b){this.options[a]=b};var notTemplate=function(a){return this._notOptions={proccessorIndexAttributeName:"data-not-template-proccindex",proccessorExpressionPrefix:"data-not-",proccessorExpressionSeparator:"-",proccessorExpressionConditionPostfix:"if",attributeExpressionItemPrefix:":",attributeExpressionHelpersPrefix:"::",attributeExpressionFunctionPostfix:"()",attributeExpressionDefaultResult:"",repeat:a.data instanceof Array,data:a.data,place:a.place,selector:a.templateName,template:a.hasOwnProperty("template")?a.template:null,templateElement:a.hasOwnProperty("templateElement")?a.templateElement:a.hasOwnProperty("templateName")?$('[data-not-template-name="'+a.templateName+'"]').cloneNode(!0):null,templateURL:a.hasOwnProperty("templateURL")?a.templateURL:null,helpers:a.helpers},console.log("data",a.data),this._working={proccessors:[],templateHTML:a.hasOwnProperty("template")?a.template:"",templateLoaded:a.hasOwnProperty("templateName")||a.hasOwnProperty("template")||a.hasOwnProperty("templateElement"),result:null,currentEl:null,currentItem:null,currentIndex:null},this};notTemplate.prototype._exec=function(){this._notOptions.repeat?this._proccessItems():(this._working.currentIndex=0,this._working.currentItem=this._notOptions.data,this._proccessItem(),this._working.result=this._working.currentEl.children)},notTemplate.prototype.exec=function(a){var b=this;if(b._working.templateLoaded){if(b._exec(),"undefined"==typeof a)return b._working.result;a(b._working.result)}else{var c=new XMLHttpRequest;c.open("GET",b._notOptions.templateURL),c.addEventListener("load",function(c){var d=document.createElement("DIV");d.dataset.notTemplateName=b._notOptions.templateURL,d.innerHTML=c.srcElement.responseText,b._working.templateLoaded=!0,b._notOptions.templateElement=d,b._exec(),"undefined"!=typeof a&&a(b._working.result)}),c.send()}},notTemplate.prototype.execAndPut=function(a,b){this.exec(function(c){if(a instanceof HTMLElement)if(a.innerHTML="",c instanceof HTMLCollection||c instanceof Array)for(var d=0;d<c.length;d++)c[d]instanceof HTMLElement&&a.appendChild(c[d]);else c instanceof HTMLElement&&a.appendChild(c);"undefined"!=typeof b&&b(c)})},notTemplate.prototype.execAndAdd=function(a,b){this.exec(function(c){if(a instanceof HTMLElement)if(c instanceof HTMLCollection||c instanceof Array)for(var d=0;d<c.length;d++)c[d]instanceof HTMLElement&&a.appendChild(c[d]);else c instanceof HTMLElement&&a.appendChild(c);"undefined"!=typeof b&&b(c)})},notTemplate.prototype._proccessItems=function(){var a;for(this._working.result=[],a=0;a<this._notOptions.data.length;a++)this._working.currentIndex=a,this._working.currentItem=this._notOptions.data[a],this._proccessItem(),this._working.result.push(this._working.currentEl.children)},notTemplate.prototype._getTemplateElement=function(){if(null===this._notOptions.template)return this._notOptions.templateElement.cloneNode(!0);var a=document.createElement("div");return a.innerHTML=this._notOptions.template,a},notTemplate.prototype._proccessItem=function(){this._working.currentEl=this._getTemplateElement(),this._findAllTemplateProccessors(),this._execProccessorsOnCurrent()},notTemplate.prototype._findAllTemplateProccessors=function(){"use strict";var a=getAttributesStartsWith(this._working.currentEl,this._notOptions.proccessorExpressionPrefix),b=null;for(this._working.proccessors=[],b=0;b<a.length;b++)for(var c=0,d=a[b].attributes,e=d.length;e>c;c++)if(0===d[c].nodeName.indexOf(this._notOptions.proccessorExpressionPrefix)){var f=this._parseProccessorExpression(d[c].nodeName);f.element=a[b],f.proccessorExpression=d[c].nodeName,f.attributeExpression=d[c].value,
this._working.proccessors.push(f)}},notTemplate.prototype._parseProccessorExpression=function(a){var b={params:[],proccessorName:"",ifCondition:!1};return a=a.replace(this._notOptions.proccessorExpressionPrefix,""),a.indexOf(this._notOptions.proccessorExpressionConditionPostfix)===a.length-this._notOptions.proccessorExpressionConditionPostfix.length&&(b.ifCondition=!0,a=a.replace(this._notOptions.proccessorExpressionSeparator+this._notOptions.proccessorExpressionConditionPostfix,"")),b.params=a.split(this._notOptions.proccessorExpressionSeparator),b.proccessorName=b.params[0],b.params=b.params.slice(1),b},notTemplate.prototype._getAttributeExpressionResult=function(a,b,c){"use strict";var d=null,e=0===a.indexOf(this._notOptions.attributeExpressionHelpersPrefix),f=0===a.indexOf(this._notOptions.attributeExpressionItemPrefix),g=a.indexOf(this._notOptions.attributeExpressionFunctionPostfix)===a.length-2,h=e?this._notOptions.helpers:b,i=a.replace(this._notOptions.attributeExpressionHelpersPrefix,"").replace(this._notOptions.attributeExpressionItemPrefix,"").replace(this._notOptions.attributeExpressionFunctionPostfix,"");return!e&&!f||null==h||"undefined"==typeof h?a:(g?d=h.hasOwnProperty(i)?h[i](b,c):this._notOptions.attributeExpressionDefaultResult:(console.log(h[i]),d="undefined"!=typeof h[i]?h[i]:this._notOptions.attributeExpressionDefaultResult),d)},notTemplate.prototype._execProccessorsOnCurrent=function(){var a;for(console.log("exec proccessors on current"),a=0;a<this._working.proccessors.length;a++)if(this._working.proccessors[a].attributeResult=this._getAttributeExpressionResult(this._working.proccessors[a].attributeExpression,this._working.currentItem,this._working.currentIndex),this.proccessorsLib.hasOwnProperty(this._working.proccessors[a].proccessorName)){var b=this._working.proccessors[a].proccessorName;this.proccessorsLib[b](this._working.proccessors[a],this._working.currentItem,this._notOptions.helpers),this._working.proccessors[a].element.removeAttribute(this._working.proccessors[a].proccessorExpression)}},notTemplate.prototype.proccessorsLib={provider:function(a){"use strict";a.params.indexOf("capitalize")>-1&&(a.attributeResult=a.attributeResult.toUpperCase()),a.element.innerHTML=a.attributeResult},options:function(a,b,c){"use strict";var d=0,e=null,f="value",g="name",h="value";if(2===a.params.length&&(g=a.params[0],f=a.params[1]),"undefined"!=typeof c&&null!==c&&c.hasOwnProperty("option")&&(g=c.option.label,f=c.option.value),3===a.params.length&&(h=a.params[2]),"undefined"!=typeof c&&null!==c&&c.hasOwnProperty("fieldPlaceHolder")&&c.hasOwnProperty("fieldPlaceHolderDefault")&&c.fieldPlaceHolderDefault&&(e=document.createElement("option"),e.setAttribute("value",""),e.textContent=c.fieldPlaceHolder,a.element.appendChild(e)),"undefined"!=typeof b&&null!==b)for(d=0;d<a.attributeResult.length;d++)e=document.createElement("option"),e.setAttribute("value",a.attributeResult[d][f]),e.textContent=a.attributeResult[d][g],"[object Array]"===Object.prototype.toString.call(b[h])?b[h].indexOf(a.attributeResult[d][f])>-1&&e.setAttribute("selected",!0):b[h]===a.attributeResult[d][f]&&e.setAttribute("selected",!0),a.element.appendChild(e)},attr:function(a){"use strict";a.element.setAttribute(a.params[0],a.attributeResult)},addclass:function(a){a.attributeResult&&a.element.classList.add(a.params[0])},value:function(a){console.log("value",a),a.element.setAttribute("value",a.attributeResult)},checked:function(a){console.log("checked",a),a.element.setAttribute("checked",a.attributeResult),console.log(a)},bind:function(a,b,c){console.log("bind",a),a.element.addEventListener(a.params[0],function(d){return d.stopImmediatePropagation(),d.preventDefault(),"undefined"!=typeof c&&null!==c&&c.hasOwnProperty(a.attributeResult)&&c[a.attributeResult](b,d),!1})}};var notView=function(a){return this.options=a,this};notView.prototype.getTemplateOptions=function(){var a={};return"undefined"!=typeof this.options.templateOptions&&null!==this.options.templateOptions?this.options.templateOptions:a},notView.prototype.getPlaceToPut=function(){return"undefined"!=typeof this.options.placeToPut&&null!==this.options.placeToPut?this.options.placeToPut:document.body},notView.prototype.getAfterExecCallback=function(a){var b=function(){console.log("default view after exec callback")};return"undefined"!=typeof a&&null!==a?a:"undefined"!=typeof this.options.afterExec&&null!==this.options.afterExec?this.options.afterExec:b},notView.prototype.exec=function(a){new notTemplate(this.getTemplateOptions()).execAndPut(this.getPlaceToPut(),this.getAfterExecCallback(a))},notView.prototype.setParam=function(a,b){return this.options[a]=b,this},notView.prototype.setTemplateParam=function(a,b){return this.options.templateOptions[a]=b,this},notView.prototype.getParam=function(a){return this.options.hasOwnProperty(a)?this.options[a]:void 0},notView.prototype.getParams=function(){return this.options};
//# sourceMappingURL=sourcemap.map